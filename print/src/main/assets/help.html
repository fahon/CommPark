<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 12">
<meta name=Originator content="Microsoft Word 12">
<link rel=File-List href="help.files/filelist.xml">
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>tang</o:Author>
  <o:LastAuthor>tang</o:LastAuthor>
  <o:Revision>17</o:Revision>
  <o:TotalTime>22</o:TotalTime>
  <o:Created>2014-10-09T08:43:00Z</o:Created>
  <o:LastSaved>2014-10-29T05:08:00Z</o:LastSaved>
  <o:Pages>2</o:Pages>
  <o:Words>1078</o:Words>
  <o:Characters>6151</o:Characters>
  <o:Lines>51</o:Lines>
  <o:Paragraphs>14</o:Paragraphs>
  <o:CharactersWithSpaces>7215</o:CharactersWithSpaces>
  <o:Version>12.00</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<link rel=themeData href="help.files/themedata.thmx">
<link rel=colorSchemeMapping href="help.files/colorschememapping.xml">
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:Zoom>BestFit</w:Zoom>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:TrackMoves>false</w:TrackMoves>
  <w:TrackFormatting/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>EN-US</w:LidThemeOther>
  <w:LidThemeAsian>ZH-CN</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:SplitPgBreakAndParaMark/>
   <w:DontVertAlignCellWithSp/>
   <w:DontBreakConstrainedForcedTables/>
   <w:DontVertAlignInTxbx/>
   <w:Word11KerningPairs/>
   <w:CachedColBalance/>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="&#45;-"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="true"
  DefSemiHidden="true" DefQFormat="false" DefPriority="99"
  LatentStyleCount="267">
  <w:LsdException Locked="false" Priority="0" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 1"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 2"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 3"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 4"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 5"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 6"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 7"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 8"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 9"/>
  <w:LsdException Locked="false" Priority="35" QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" Priority="10" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" Priority="1" Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" Priority="11" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" Priority="22" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" Priority="20" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" Priority="59" SemiHidden="false"
   UnhideWhenUsed="false" Name="Table Grid"/>
  <w:LsdException Locked="false" UnhideWhenUsed="false" Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" UnhideWhenUsed="false" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" QFormat="true" Name="TOC Heading"/>
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 680460288 22 0 262145 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-536870145 1107305727 0 0 415 0;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-536870145 1073743103 0 0 415 0;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 680460288 22 0 262145 0;}
@font-face
	{font-family:楷体_GB2312;
	mso-font-alt:"Arial Unicode MS";
	mso-font-charset:134;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:0 135135232 16 0 262144 0;}
@font-face
	{font-family:"\@楷体_GB2312";
	mso-font-charset:134;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:0 135135232 16 0 262144 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
h1
	{mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"标题 1 Char";
	mso-style-next:正文;
	margin-top:17.0pt;
	margin-right:0cm;
	margin-bottom:16.5pt;
	margin-left:0cm;
	line-height:240%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:22.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;
	mso-font-kerning:22.0pt;}
h2
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"标题 2 Char";
	mso-style-next:正文;
	margin-top:13.0pt;
	margin-right:0cm;
	margin-bottom:13.0pt;
	margin-left:0cm;
	line-height:172%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:16.0pt;
	font-family:"Cambria","serif";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:宋体;
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;}
h3
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"标题 3 Char";
	mso-style-next:正文;
	margin-top:13.0pt;
	margin-right:0cm;
	margin-bottom:13.0pt;
	margin-left:0cm;
	line-height:172%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:16.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
h4
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"标题 4 Char";
	mso-style-next:正文;
	margin-top:14.0pt;
	margin-right:0cm;
	margin-bottom:14.5pt;
	margin-left:0cm;
	line-height:155%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:宋体;
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;}
p.MsoNoSpacing, li.MsoNoSpacing, div.MsoNoSpacing
	{mso-style-priority:1;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:14.0pt;
	mso-bidi-font-size:11.0pt;
	font-family:"Arial","sans-serif";
	mso-fareast-font-family:楷体_GB2312;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	margin:0cm;
	margin-bottom:.0001pt;
	text-indent:21.0pt;
	mso-char-indent-count:2.0;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
span.1Char
	{mso-style-name:"标题 1 Char";
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"标题 1";
	mso-ansi-font-size:22.0pt;
	mso-bidi-font-size:22.0pt;
	font-family:宋体;
	mso-ascii-font-family:宋体;
	mso-fareast-font-family:宋体;
	mso-hansi-font-family:宋体;
	mso-bidi-font-family:宋体;
	mso-font-kerning:22.0pt;
	font-weight:bold;}
span.2Char
	{mso-style-name:"标题 2 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"标题 2";
	mso-ansi-font-size:16.0pt;
	mso-bidi-font-size:16.0pt;
	font-family:"Cambria","serif";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:宋体;
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	font-weight:bold;}
span.3Char
	{mso-style-name:"标题 3 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"标题 3";
	mso-ansi-font-size:16.0pt;
	mso-bidi-font-size:16.0pt;
	font-family:宋体;
	mso-ascii-font-family:宋体;
	mso-fareast-font-family:宋体;
	mso-hansi-font-family:宋体;
	mso-bidi-font-family:宋体;
	font-weight:bold;}
span.4Char
	{mso-style-name:"标题 4 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"标题 4";
	mso-ansi-font-size:14.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:"Cambria","serif";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:宋体;
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	font-weight:bold;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	font-size:10.0pt;
	mso-ansi-font-size:10.0pt;
	mso-bidi-font-size:10.0pt;
	mso-ascii-font-family:"Times New Roman";
	mso-hansi-font-family:"Times New Roman";
	mso-font-kerning:0pt;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:684599060;
	mso-list-type:hybrid;
	mso-list-template-ids:-141251942 1021058390 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l0:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:18.0pt;
	text-indent:-18.0pt;
	mso-ansi-font-size:16.0pt;
	mso-ansi-font-weight:bold;}
@list l0:level2
	{mso-level-tab-stop:72.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level3
	{mso-level-tab-stop:108.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level4
	{mso-level-tab-stop:144.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level5
	{mso-level-tab-stop:180.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level6
	{mso-level-tab-stop:216.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level7
	{mso-level-tab-stop:252.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level8
	{mso-level-tab-stop:288.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level9
	{mso-level-tab-stop:324.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1
	{mso-list-id:1131947016;
	mso-list-type:hybrid;
	mso-list-template-ids:-144029764 -1499401646 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l1:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:18.0pt;
	text-indent:-18.0pt;
	mso-ansi-font-size:16.0pt;
	mso-ansi-font-weight:bold;}
@list l1:level2
	{mso-level-tab-stop:72.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1:level3
	{mso-level-tab-stop:108.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1:level4
	{mso-level-tab-stop:144.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1:level5
	{mso-level-tab-stop:180.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1:level6
	{mso-level-tab-stop:216.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1:level7
	{mso-level-tab-stop:252.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1:level8
	{mso-level-tab-stop:288.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1:level9
	{mso-level-tab-stop:324.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l2
	{mso-list-id:1327635652;
	mso-list-type:hybrid;
	mso-list-template-ids:127983932 -311395452 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l2:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:19.5pt;
	text-indent:-19.5pt;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:普通表格;
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-qformat:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman","serif";}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="4098"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=ZH-CN style='tab-interval:21.0pt'>

<div class=Section1>

<h1><span class=SpellE><span lang=EN-US>AndroidPrinterDemo</span></span><span
lang=EN-US> </span>开发帮助模块内容 </h1>

<h2><span style='font-family:宋体;mso-ascii-font-family:Cambria;mso-ascii-theme-font:
major-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:Cambria;mso-hansi-theme-font:major-latin'>连接原理及示例代码</span></h2>

<p class=MsoNormal><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;
</span><span class=SpellE>AndroidPrinterSDK</span> </span>提供通过<span lang=EN-US>
Bluetooth</span>、<span lang=EN-US>WIFI</span>、<span lang=EN-US>USB </span>三种方式和打印机进行连接的方法。
具体调用的方法详见<span lang=EN-US> <span class=SpellE>AndroidPrinterDemo</span> </span>中<span
lang=EN-US> <span class=SpellE>com.android.print.demo</span> </span>包下的<span
lang=EN-US> BluetoothOperation.java</span>、<span lang=EN-US>WifiOperation.java</span>、<span
lang=EN-US>UsbOperation.java </span>三个类中。 </p>

<p class=MsoNormal style='text-indent:24.0pt;mso-char-indent-count:2.0'>以<span
lang=EN-US> Bluetooth </span>为例 ：</p>

<p class=MsoNormal style='text-indent:24.0pt;mso-char-indent-count:2.0'><span
class=SpellE><span lang=EN-US>PrinterInstance</span></span><span lang=EN-US> <span
class=SpellE>mPrinter</span>=new <span class=SpellE><span class=GramE>BluetoothPort</span></span><span
class=GramE>(</span>).<span class=SpellE>btConnnect</span>(<span class=SpellE>mContext</span>,
<span class=SpellE>mac</span>, adapter, <span class=SpellE>mHandler</span>); </span></p>

<h4><span class=SpellE><span lang=EN-US>mContext</span></span><span lang=EN-US>
</span><span style='font-family:宋体;mso-ascii-font-family:Cambria;mso-ascii-theme-font:
major-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:Cambria;mso-hansi-theme-font:major-latin'>为当前上下文对象，类型为</span><span
lang=EN-US>Context</span><span style='font-family:宋体;mso-ascii-font-family:
Cambria;mso-ascii-theme-font:major-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:
major-fareast;mso-hansi-font-family:Cambria;mso-hansi-theme-font:major-latin'>；</span></h4>

<p class=MsoListParagraph style='margin-left:18.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l1 level1 lfo2'><![if !supportLists]><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:16.0pt;
mso-bidi-font-size:12.0pt'><span style='mso-list:Ignore'>1.</span></span></b><![endif]><span
lang=EN-US>adapter </span><span class=GramE>为蓝牙适配器</span>。 </p>

<p class=MsoNormal style='text-indent:36.0pt;mso-char-indent-count:3.0'><span
class=SpellE><span lang=EN-US>BluetoothAdapter</span></span><span lang=EN-US>
adapter = <span class=SpellE><span class=GramE>BluetoothAdapter.getDefaultAdapter</span></span><span
class=GramE>(</span>);</span></p>

<p class=MsoListParagraph style='margin-left:18.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l1 level1 lfo2'><![if !supportLists]><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:16.0pt;
mso-bidi-font-size:12.0pt'><span style='mso-list:Ignore'>2.</span></span></b><![endif]><span
class=SpellE><span lang=EN-US>mac</span></span><span lang=EN-US> </span>为目标设备<span
class=GramE>的蓝牙地址</span>，可通过扫描<span class=GramE>附近蓝牙的</span>方式获得。 </p>

<p class=MsoNormal style='text-indent:30.0pt;mso-char-indent-count:2.5'><span
class=SpellE><span class=GramE><span lang=EN-US>adapter.startDiscovery</span></span></span><span
class=GramE><span lang=EN-US>(</span></span><span lang=EN-US>); </span></p>

<p class=MsoNormal style='text-indent:30.0pt;mso-char-indent-count:2.5'>扫描前需注册<span
lang=EN-US> <span class=SpellE>BroadcastReceiver</span> </span>，详见<span
lang=EN-US> <span class=SpellE>BluetoothDeviceList</span> </span>中<span
lang=EN-US> <span class=SpellE>mReceiver</span> </span>的注册与使用，当扫描到周围设备时，<span
class=SpellE><span lang=EN-US>device.getAddress</span></span><span lang=EN-US>()
</span>即可获得。 </p>

<p class=MsoListParagraph style='margin-left:18.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l1 level1 lfo2'><![if !supportLists]><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:16.0pt;
mso-bidi-font-size:12.0pt'><span style='mso-list:Ignore'>3.</span></span></b><![endif]><span
class=SpellE><span lang=EN-US>mHandler</span></span><span lang=EN-US> </span>为消息接收器。需自定义。详见<span
lang=EN-US> MainActivity.java </span>中的<span lang=EN-US> <span class=SpellE>mHandler</span></span>。
设定此<span lang=EN-US> handler </span>的作用时，当连接成功时，<span lang=EN-US>SDK </span>会发送固定消息给此<span
lang=EN-US> handler</span>，以便识别连接状态和更新<span lang=EN-US>UI</span>。 </p>

<p class=MsoListParagraph style='margin-left:18.0pt;mso-para-margin-left:1.5gd;
text-indent:0cm;mso-char-indent-count:0'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h2><span style='font-family:宋体;mso-ascii-font-family:Cambria;mso-ascii-theme-font:
major-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:major-fareast;
mso-hansi-font-family:Cambria;mso-hansi-theme-font:major-latin'>打印原理及示例代码</span>
</h2>

<p class=MsoListParagraph style='margin-left:18.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l0 level1 lfo4'><![if !supportLists]><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:16.0pt;
mso-bidi-font-size:12.0pt'><span style='mso-list:Ignore'>1.</span></span></b><![endif]><span
class=SpellE><span lang=EN-US>AndroidPrinterSDK</span></span><span lang=EN-US> </span>提供的打印功能包括
打印文本，打印图片，打印表格，打印条码。 </p>

<p class=MsoListParagraph style='margin-left:18.0pt;mso-para-margin-left:1.5gd;
text-indent:12.0pt;mso-char-indent-count:1.0'>以上功能均需由连接成功的打印机实例调用。 如<span
lang=EN-US> <span class=SpellE>mPrinter.printText</span>();<span class=SpellE>mPrinter.printImage</span>();
<span class=SpellE>mPrinter.printTable</span>();<span class=SpellE>mPrinter.printBarCode</span>();
</span>以此为基础可拓展的功能包括，打印文件，打印画布，打印小票等。详见<span lang=EN-US> <span class=SpellE>AndroidPrinterDemo</span>
</span>中<span lang=EN-US> <span class=SpellE>com.android.print.demo.utils</span>
</span>包下<span lang=EN-US> PrintUtils.java </span>。 </p>

<p class=MsoNormal><span class=3Char><span lang=EN-US style='font-size:16.0pt'>2.</span></span>打印流程有两种。
</p>

<p class=MsoListParagraph style='margin-left:18.0pt;mso-para-margin-left:1.5gd;
text-indent:21.1pt;mso-char-indent-count:1.5'><span class=4Char><span
lang=EN-US style='font-size:14.0pt'>(1)</span></span><span lang=EN-US>.</span>连接<span
lang=EN-US> - </span>打印<span lang=EN-US> - </span>打印<span lang=EN-US> - </span>…<span
lang=EN-US> - </span>关闭<span lang=EN-US> . </span>优点是打印间隔时间短，打印速度快，但如果有需求，<span
class=GramE>实现蓝牙断线</span>监测，<span class=GramE>蓝牙自动</span>回连等功能需手动实现。 </p>

<p class=MsoListParagraph style='margin-left:18.0pt;mso-para-margin-left:1.5gd;
text-indent:21.1pt;mso-char-indent-count:1.5'><span class=4Char><span
lang=EN-US style='font-size:14.0pt'>(2)</span></span><span lang=EN-US>.</span>连接<span
lang=EN-US> - </span>打印<span lang=EN-US> - </span>关闭 连接<span lang=EN-US> - </span>打印<span
lang=EN-US> - </span>关闭<span lang=EN-US> . </span>优点是可<span class=GramE>避免蓝牙断线</span>监测，自动回连等功能的实现，但打印间隔时间长，打印速度较慢。
</p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h2><span class=GramE><span style='font-family:宋体;mso-ascii-font-family:Cambria;
mso-ascii-theme-font:major-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:
major-fareast;mso-hansi-font-family:Cambria;mso-hansi-theme-font:major-latin'>蓝牙断线</span></span><span
style='font-family:宋体;mso-ascii-font-family:Cambria;mso-ascii-theme-font:major-latin;
mso-fareast-font-family:宋体;mso-fareast-theme-font:major-fareast;mso-hansi-font-family:
Cambria;mso-hansi-theme-font:major-latin'>监测和自动回连。</span></h2>

<p class=MsoNormal><span class=2Char><span lang=EN-US style='font-size:16.0pt'>1.</span></span><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp; </span></span><span
class=GramE>蓝牙断线</span>监测的实现方式有两种。</p>

<p class=MsoNormal style='text-indent:7.85pt;mso-char-indent-count:.49'><span
class=3Char><span lang=EN-US style='font-size:16.0pt'><span
style='mso-spacerun:yes'>&nbsp;</span>(1).</span></span>利用<span lang=EN-US>
Android </span>底层提供的广播接收器 。 </p>

<p class=MsoListParagraph style='margin-left:18.0pt;mso-para-margin-left:1.5gd;
text-indent:24.0pt'>详见<span lang=EN-US> BluetoothOpreation.java </span>中的<span
lang=EN-US> <span class=SpellE>myReceiver</span> </span>的注册和使用。此种方法的原理为，<span
lang=EN-US>Android </span>底层每隔<span lang=EN-US>20</span>秒会进行<span class=GramE>一次蓝牙连接</span>状态的检测。如果<span
class=GramE>发现蓝牙断开</span>，会进行广播。该注册器就能收到对应的广播信息。从而<span class=GramE>实现蓝牙断线</span>的监测。优点是实现方法简单，但缺点是状态监测不精确。监测到断线的时间取决于断线的时间点。比如，若在上<span
class=GramE>一次蓝牙检测</span>之后<span lang=EN-US>1</span>秒断线，则监测<span class=GramE>到蓝牙断线</span>需要到<span
lang=EN-US>20</span>秒之后；若在下<span class=GramE>一次蓝牙检测</span>之前<span lang=EN-US>1</span>秒断线，则监测<span
class=GramE>到蓝牙断线</span>只需要到<span lang=EN-US>1</span>秒之后。 <span lang=EN-US><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:15.75pt;mso-char-indent-count:.98'><span
class=3Char><span lang=EN-US style='font-size:16.0pt'><2>(2).</span></span><span
lang=EN-US> </span>利用自定义心跳线程实现。 </p>

<p class=MsoListParagraph style='margin-left:18.0pt;mso-para-margin-left:1.5gd;
text-indent:24.0pt'>此种方法的原理为，<span class=GramE>在蓝牙连接</span>成功之后，启动一个心跳线程。该线程可调用<span
lang=EN-US> <span class=SpellE>AndroidPrinterSDK</span> </span>提供的<span
lang=EN-US> <span class=SpellE>Utils.getPrinterStatus</span>() </span>方法。该方法向打印机发送指令以获得打印机当前的状态。返回值中：<span
lang=EN-US>0</span>表示状态正常，<span lang=EN-US>1</span>表示缺纸，<span lang=EN-US>2</span>表示上盖打开，<span
lang=EN-US>3</span>表示未读到值。故若返回值为<span lang=EN-US>3</span>，则可<span class=GramE>判定蓝牙已经</span>断线。<span
class=GramE>另此方法</span>可传递超时参数，以此控制心跳线程的频率。优点是状态监测精度可调整，缺点是<span class=GramE>若心</span>跳线程频率太短，消耗的资源会很大。
</p>

<p class=MsoListParagraph style='margin-left:18.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l0 level1 lfo4'><![if !supportLists]><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:16.0pt;
mso-bidi-font-size:12.0pt'><span style='mso-list:Ignore'>2.</span></span></b><![endif]><span
class=GramE>蓝牙自动</span>回连的方式<span lang=EN-US>.</span></p>

<p class=MsoListParagraph style='margin-left:18.0pt;text-indent:0cm;mso-char-indent-count:
0'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span>参考断线监测的心跳线程方式。不同点在于，监测<span
class=GramE>到蓝牙断线</span>之后，调用的是连接函数进行尝试连接。若连接成功，表明可回连。此种方式消耗资源也较大，一般若<span
class=GramE>对蓝牙自动</span>回连有较高需求时，建议采用打印流程的第二种进行避免。 </p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h2><span class=GramE><span style='font-family:宋体;mso-ascii-font-family:Cambria;
mso-ascii-theme-font:major-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:
major-fareast;mso-hansi-font-family:Cambria;mso-hansi-theme-font:major-latin'>蓝牙快速</span></span><span
style='font-family:宋体;mso-ascii-font-family:Cambria;mso-ascii-theme-font:major-latin;
mso-fareast-font-family:宋体;mso-fareast-theme-font:major-fareast;mso-hansi-font-family:
Cambria;mso-hansi-theme-font:major-latin'>连接。</span> </h2>

<p class=MsoNormal style='text-indent:24.0pt;mso-char-indent-count:2.0'><span
class=SpellE><span lang=EN-US>AndroidPrinterSDK</span></span><span lang=EN-US> </span>提供保存与<span
class=GramE>提取蓝牙地址</span>的方法。当检测<span class=GramE>到蓝牙绑定</span>或连接成功之后，可调用<span
class=SpellE><span lang=EN-US>Utils.saveBtConnInfo</span></span><span
lang=EN-US>()</span>方法，<span class=GramE>将蓝牙地址</span>传入保存。下一次连接前调用<span
class=SpellE><span lang=EN-US>Utils.getBtConnInfo</span></span><span
lang=EN-US>()</span>，即可取得保存<span class=GramE>的蓝牙地址</span>，<span class=GramE>省去蓝牙扫描</span>与选择设备的时间。保存的地址关闭<span
lang=EN-US>APP</span>后重新进入时依然可以取得。但需注意，最多只能保存<span class=GramE>一个蓝牙地址</span>，即每一次<span
class=GramE>保存蓝牙地址</span>，都会覆盖上一次保存的地址。</p>

<p class=MsoNormal style='text-indent:24.0pt;mso-char-indent-count:2.0'><span
lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;mso-char-indent-count:2.0'><span
lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;mso-char-indent-count:2.0'><span
lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h1><span lang=EN-US>The content of <span class=SpellE>AndroidPrinterDemo</span>
development help document</span></h1>

<p class=MsoNoSpacing><span lang=EN-US style='color:black;mso-themecolor:text1'>Connection
Theory and Sample Code<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span lang=EN-US>AndroidPrinterSDK</span></span><span
lang=EN-US> supplies three ways C Bluetooth, WIFI, <span class=GramE>USB</span>
to connect with the printer. The detailed methods can be referred to&nbsp;three
<span class=GramE>CLASS</span> C “BluetoothOperation.java”, “WifiOperation.java”,
“UsbOperation.java” in “<span class=SpellE>com.android.print.demo</span>” of “<span
class=SpellE>AndroidPrinterDemo</span>”.</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;</span></span></p>

<p class=MsoNormal><a name="OLE_LINK2"></a><a name="OLE_LINK1"><span
style='mso-bookmark:OLE_LINK2'><span lang=EN-US>The example of Bluetooth:</span></span></a></p>

<span style='mso-bookmark:OLE_LINK2'></span><span style='mso-bookmark:OLE_LINK1'></span>

<p class=MsoNormal><span class=SpellE><span lang=EN-US>PrinterInstance</span></span><span
lang=EN-US> <span class=SpellE>mPrinter</span>=new <span class=SpellE><span
class=GramE>BluetoothPort</span></span><span class=GramE>(</span>).<span
class=SpellE>btConnnect</span>(<span class=SpellE>mContext</span>, <span
class=SpellE>mac</span>, adapter, <span class=SpellE>mHandler</span>); </span></p>

<p class=MsoNormal><span class=SpellE><span class=GramE><span lang=EN-US>mContext</span></span></span><span
lang=EN-US> is the object of current context. Type is “Context”</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>1.<span style='mso-tab-count:1'>&nbsp; </span>Adapter
is Bluetooth Adapter</span></p>

<p class=MsoListParagraph style='text-indent:24.0pt'><span class=SpellE><span
lang=EN-US>BluetoothAdapter</span></span><span lang=EN-US> adapter = <span
class=SpellE><span class=GramE>BluetoothAdapter.getDefaultAdapter</span></span><span
class=GramE>(</span>);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>2.<span style='mso-tab-count:1'>&nbsp; </span><span
class=SpellE><span class=GramE>mac</span></span> is the Bluetooth address of
target device. It can be gained by scanning the nearby Bluetooth.</span></p>

<p class=MsoNormal><span class=SpellE><span class=GramE><span lang=EN-US>adapter.startDiscovery</span></span></span><span
class=GramE><span lang=EN-US>(</span></span><span lang=EN-US>);</span></p>

<p class=MsoNormal><span class=SpellE><span lang=EN-US>BroadcastReceiver</span></span><span
lang=EN-US> needs to be registered before scanning. <span class=SpellE>Pls</span>
refer to the details of registration and using of “<span class=SpellE>myReceiver</span>”
in “BluetoothOpreation.java”. When the surrounding device is scanned, <span
class=SpellE><span class=GramE>device.getAddress</span></span><span
class=GramE>(</span>)&nbsp;can be gained.</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;</span></span></p>

<p class=MsoNormal><span lang=EN-US>3.<span style='mso-tab-count:1'>&nbsp; </span><span
class=SpellE><span class=GramE>mHandler</span></span>&nbsp;is message receiver.
It needs to be user-defined. The details can be checked in “<span class=SpellE>mHandler</span>”
of “MainActivity.java”. After the function of this “handler: is set, when the
connection is successfully, SDK will send the confirmed message to this “handler
to recognize the connection status and update UI.</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><a name="OLE_LINK4"></a><a name="OLE_LINK3"><span
style='mso-bookmark:OLE_LINK4'><span lang=EN-US style='color:black;mso-themecolor:
text1'>Printing Theory and Sample Code<o:p></o:p></span></span></a></p>

<p class=MsoNormal><span style='mso-bookmark:OLE_LINK3'><span style='mso-bookmark:
OLE_LINK4'><span lang=EN-US>1.<span style='mso-tab-count:1'>&nbsp; </span>All
the above functions need to be called on the successfully connected printer. </span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:OLE_LINK3'><span style='mso-bookmark:
OLE_LINK4'><span lang=EN-US>e.g. <span class=SpellE><span class=GramE>mPrinter.printText</span></span><span
class=GramE>(</span>);<span class=SpellE>mPrinter.printImage</span>();</span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:OLE_LINK3'><span style='mso-bookmark:
OLE_LINK4'><span class=SpellE><span class=GramE><span lang=EN-US>mPrinter.printTable</span></span></span><span
class=GramE><span lang=EN-US>(</span></span><span lang=EN-US>);<span
class=SpellE>mPrinter.printBarCode</span>();</span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:OLE_LINK3'><span style='mso-bookmark:
OLE_LINK4'><span lang=EN-US>Basing on this code, extended functions can be:
printing document, printing image, printing receipt, etc.<a name="_GoBack"></a></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:OLE_LINK3'><span style='mso-bookmark:
OLE_LINK4'><span lang=EN-US>The detail refers: the “PrintUtils.java” of package
“<span class=SpellE>com.android.print.demo.utils</span>” in of “<span
class=SpellE>AndroidPrinterDemo</span>”.</span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:OLE_LINK3'><span style='mso-bookmark:
OLE_LINK4'><span lang=EN-US>2. There are two methods to control printing print
work.</span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:OLE_LINK3'><span style='mso-bookmark:
OLE_LINK4'><span lang=EN-US>(1). Connect-print-print-…...-close. In this mode,
the advantage is shorter interval and faster printing speed of print but
disadvantage is the functions of “Bluetooth Disconnection Monitor Connecting
Watch” and “Automatic Reconnection” <span class=GramE>have</span> to be set by
manual. </span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:OLE_LINK3'><span style='mso-bookmark:
OLE_LINK4'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:OLE_LINK3'><span style='mso-bookmark:
OLE_LINK4'><span lang=EN-US>(2). Connect C print - close, connect C print C
close.<span style='mso-spacerun:yes'>&nbsp; </span>In this mode, the advantage
is needn’t control the functions of “Bluetooth Disconnection Monitor connecting
watch” and “Automatic Reconnection ” are not needed but disadvantage is longer
interval and slower printing speed.</span></span></span></p>

<span style='mso-bookmark:OLE_LINK4'></span><span style='mso-bookmark:OLE_LINK3'></span>

<p class=MsoNormal><span lang=EN-US style='color:black;mso-themecolor:text1'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=EN-US style='color:black;mso-themecolor:text1'>Bluetooth
Disconnection Monitoring and Automatic Reconnection<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:black;mso-themecolor:text1'><o:p>&nbsp;</o:p></span></p>

<p class=MsoListParagraphCxSpFirst style='margin-top:0cm;margin-right:0cm;
margin-bottom:10.0pt;margin-left:19.5pt;mso-add-space:auto;text-indent:-19.5pt;
mso-char-indent-count:0;line-height:115%;mso-list:l2 level1 lfo5'><![if !supportLists]><b><span
lang=EN-US style='font-size:16.0pt;line-height:115%;color:black;mso-themecolor:
text1;mso-font-kerning:18.0pt'><span style='mso-list:Ignore'>1.<span
style='font:7.0pt "Times New Roman"'> </span></span></span></b><![endif]><b><span
lang=EN-US style='font-size:16.0pt;line-height:115%;color:black;mso-themecolor:
text1;mso-font-kerning:18.0pt'>Two ways to monitor the <span class=SpellE>bluetooth</span>
disconnection<o:p></o:p></span></b></p>

<p class=MsoListParagraph style='margin-left:19.5pt;text-indent:24.0pt'><span
lang=EN-US style='color:black;mso-themecolor:text1'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:black;mso-themecolor:text1'><span
style='mso-spacerun:yes'>&nbsp;</span>(1). Use the “broadcast receiver” which
it provided by Android underlying.<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span lang=EN-US style='mso-bidi-font-size:
14.0pt;color:black;mso-themecolor:text1'>Pls</span></span><span lang=EN-US
style='mso-bidi-font-size:14.0pt;color:black;mso-themecolor:text1'> refer to
the details of registration and using of “<span class=SpellE>myReceiver</span>”
in “BluetoothOpreation.java”. In this method, <span class=GramE>Android</span>
underlying detects the Bluetooth connection status once per 20seconds. If the
Bluetooth is unconnected, it will broadcast. This receiver will receive the
related broadcast message; while the Bluetooth Disconnection Monitoring is
implemented.<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-bidi-font-size:14.0pt;
color:black;mso-themecolor:text1'>The advantage of this method is simple but
disadvantage is inaccuracy. The detected disconnection time depends on the
point of unconnected time. For example, if the disconnection happens after 1
second of the last detection, it has to be monitored 20seconds later; if the
disconnection happens before 1 second of the last detection, it will be
monitored only 1 second later.<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:black;mso-themecolor:text1'><span
style='mso-spacerun:yes'>&nbsp;</span>(2). Use the user-defined Heartbeat
Daemon to implementation.<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-bidi-font-size:14.0pt;
color:black;mso-themecolor:text1'>In this method, after the Bluetooth is
connected successfully, launch one heartbeat daemon. In this daemon, the method
of “<span class=SpellE><span class=GramE>Utils.getPrinterStatus</span></span><span
class=GramE>(</span>)&nbsp;” supplied in <span class=SpellE>AndroidPrinterSDK</span>
can be called. Using this method to send commands to the printer and get the
current status of printer. For returned values: 0 means the normal status, 1
means out of paper, 2 means the upper cover is open, 3 means no value is read.
If the returned value is 3, it can be confirmed the Bluetooth has been
disconnected. This method can transmit overtime parameter to control the
frequency of heartbeat daemon. The advantage is the monitor precision can be adjustable;
while the disadvantage is the frequency of heartbeat daemon is too short and
the wasting resources will be much. <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:black;mso-themecolor:text1'><o:p>&nbsp;</o:p></span></p>

<p class=MsoListParagraphCxSpFirst style='margin-top:0cm;margin-right:0cm;
margin-bottom:10.0pt;margin-left:19.5pt;mso-add-space:auto;text-indent:-19.5pt;
mso-char-indent-count:0;line-height:115%;mso-list:l2 level1 lfo5'><![if !supportLists]><span
lang=EN-US style='color:black;mso-themecolor:text1'><span style='mso-list:Ignore'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span></span><![endif]><span
lang=EN-US style='color:black;mso-themecolor:text1'>The method of Bluetooth
Automatic Reconnecting.<o:p></o:p></span></p>

<p class=MsoListParagraph style='margin-left:19.5pt;text-indent:24.0pt'><span
lang=EN-US style='color:black;mso-themecolor:text1'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-bidi-font-size:14.0pt;
color:black;mso-themecolor:text1'>Refer to the heartbeat daemon method of Bluetooth
disconnection monitor. The difference is that the connection function is called
to try the connection after the Bluetooth disconnection is monitored. If the
connection is successful, it means the reconnection can be ok. The wasting
resources of this method are also much. If there is high request for Bluetooth
reconnection, this second printing method is suggested to use to save the
resource.<span style='mso-spacerun:yes'>&nbsp; </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:black;mso-themecolor:text1'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:black;mso-themecolor:text1'><span
style='mso-spacerun:yes'>&nbsp;</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:14.0pt;mso-bidi-font-size:
11.0pt;font-family:"Arial","sans-serif";mso-fareast-font-family:楷体_GB2312;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
color:black;mso-themecolor:text1'>Bluetooth quick connect<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span lang=EN-US style='mso-bidi-font-size:
14.0pt;color:black;mso-themecolor:text1'>AndroidPrinterSDK</span></span><span
lang=EN-US style='mso-bidi-font-size:14.0pt;color:black;mso-themecolor:text1'>
supplies the method of </span><span lang=EN-US style='color:black;mso-themecolor:
text1'>SAVE and GET</span><span lang=EN-US style='mso-bidi-font-size:14.0pt;
color:black;mso-themecolor:text1'> the Bluetooth address. When the Bluetooth
binding or successful connection is detected, “<span class=SpellE><span
class=GramE>Utils.saveBtConnInfo</span></span><span class=GramE>(</span>)”
method can be called and save the Bluetooth address. Next time, call “<span
class=SpellE><span class=GramE>Utils.getBtConnInfo</span></span><span
class=GramE>(</span>)” before the connection to get the saved Bluetooth address
and save the time of scanning &amp; choosing device. The saved Bluetooth
address can be still got after restarting the APP. <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:black;mso-themecolor:text1'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:black;mso-themecolor:text1'>Note:
only one MAC address can be saved. When new address <span class=GramE>is <span
style='mso-spacerun:yes'>&nbsp;</span>saved</span>, the old one will be covered.<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;mso-char-indent-count:2.0'><span
lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoListParagraph style='margin-left:18.0pt;mso-para-margin-left:1.5gd;
text-indent:24.0pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoListParagraph style='margin-left:18.0pt;mso-para-margin-left:1.5gd;
text-indent:24.0pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoListParagraph style='margin-left:18.0pt;mso-para-margin-left:1.5gd;
text-indent:24.0pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoListParagraph style='margin-left:18.0pt;mso-para-margin-left:1.5gd;
text-indent:24.0pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoListParagraph style='margin-left:18.0pt;mso-para-margin-left:1.5gd;
text-indent:24.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;</span></span></p>

</div>

</body>

</html>
